<ui:composition template="/base/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://java.sun.com/jstl/core"
                xmlns:ui="http://java.sun.com/jsf/facelets">


    <ui:define name="title">GhostNetFishing</ui:define>

    <ui:define name="content">
        <div class="card ui-fluit">
            <h:form>
                <p:dataTable var="ghostnet" value="#{ghostnetOverviewController.lazyModel}" paginator="true" rows="5"
                             paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
                             rowsPerPageTemplate="5,10,100" id="ghostnetTable" lazy="true">
                    <p:column headerText="Status">
                        <h:outputText value="#{ghostnet.status}"/>
                    </p:column>
                    <p:column headerText="Meldende Person">
                        <h:outputText value="#{ghostnet.id}"/>
                    </p:column>
                    <p:column headerText="gesch. Größe">
                        <h:outputText value="#{ghostnet.size}"/>
                    </p:column>
                    <p:column headerText="Breitengrad">
                        <h:outputText value="#{ghostnet.latitude}"/>
                    </p:column>
                    <p:column headerText="Längengrad">
                        <h:outputText value="#{ghostnet.longitude}"/>
                    </p:column>
                    <p:column headerText="Bergende Person">
                        <h:outputText value="#{ghostnet.reporterName}"/>
                    </p:column>
                    <p:column headerText="Bergende Person Telefonnummer">
                        <h:outputText value="#{ghostnet.phoneNumber}"/>
                    </p:column>
                    <p:column headerText="">
                        <p:menuButton dynamic="true" value="Status ändern"
                                      buttonStyleClass="ui-button-outlined">
                            <c:if test="#{userService.isLoggedIn}">
                                
                                <p:menuitem dynamic="true" action="#{ghostnetOverviewController.changeStatus(ghostnet, 'RecoveryImminent')}"
                                            ajax="false">
                                    Test: <h:outputText value="#{ghostnet.id}"/>
                                </p:menuitem>
                                <p:menuitem dynamic="true" value="Bergung bevorstehend"
                                            oncomplete="dialog.show()" update=":dialog"
                                            actionListener="#{ghostnetOverviewController.changeStatus(ghostnet, 'RecoveryImminent')}"
                                            ajax="false"/>
                                <p:menuitem value="Geborgen"
                                            action="#{ghostnetOverviewController.changeStatus(ghostnet, 'Recovered')}"
                                            ajax="false"/>
                                <p:menuitem value="Verschollen"
                                            action="#{ghostnetOverviewController.changeStatus(ghostnet, 'Lost')}"
                                            ajax="false"/>
                            </c:if>
                            <c:if test="#{!userService.isLoggedIn}">
                                <p:menuitem value="Aktionen nur für eingeloggte Benutzer"/>
                            </c:if>
                        </p:menuButton>
                    </p:column>
                </p:dataTable>
            </h:form>
            
        </div>
    </ui:define>
</ui:composition>

